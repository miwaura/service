# This is a default site configuration which will simply return 404, preventing
# chance access to any other virtualhost.
server {

                listen 80 default_server;
                listen [::]:80 default_server;
                return 301 https://$host$request_uri;

}
server {
        listen 443 ssl default_server;
        listen [::]:443 ssl default_server;

        # ssl on;
        ssl_certificate     /etc/nginx/ssl/server.crt;
        ssl_certificate_key /etc/nginx/ssl/server.key;
        # SSL configuration
        #
        # listen 443 ssl default_server;
        # listen [::]:443 ssl default_server;
        #
        # Note: You should disable gzip for SSL traffic.
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        # include snippets/snakeoil.conf;

        root /var/lib/nginx/html;

        index index.html index.htm index.nginx-debian.html index.php;

        server_name _;
        access_log /var/log/nginx/access.log;
        error_log /var/log/nginx/error.log;
        location / {
                autoindex on;
                try_files $uri $uri/ =404;
        }
        location /wordpress {
        return 301 http://localhost:5050/wordpress/;
        try_files $uri $uri/ /index.php?$args;
        }
#       location /phpmyadmin {
#               root /usr/share;
#               index index.php;

#               location ~ ^/phpmyadmin.+\.php$ {
#                               fastcgi_pass   unix:/var/run/php5-fpm.sock;
#                               fastcgi_index  index.php;
#                               fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;
#                               include        fastcgi_params;
#     }
#   }php変更前
        # location ~ \.php$ {
        #         try_files $uri =404;
        #         include /etc/nginx/fastcgi_params;
        #         fastcgi_read_timeout 3600s;
        #         fastcgi_buffer_size 128k;
        #         fastcgi_buffers 4 128k;
        #         fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        #         fastcgi_pass unix:/run/php/php7.3-fpm.sock;
        #         fastcgi_index index.php;
        #                 }
        location ~ \.php$ {
		try_files $uri =404;
		include /etc/nginx/fastcgi_params;
		fastcgi_read_timeout 3600s;
		fastcgi_buffer_size 128k;
		fastcgi_buffers 4 128k;
		fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
		fastcgi_pass 127.0.0.1:9000;
		# fastcgi_pass unix:/run/php/php7.3-fpm.sock;
                # 追加
                index index.html index.htm index.nginx-debian.html index.php;
		fastcgi_index index.php;
			}
}